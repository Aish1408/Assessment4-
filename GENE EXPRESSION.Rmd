---
title: "RNA-Seq Analysis, Growth Data Analysis, and Biological Sequence Diversity
  in Comparative Genomics"
author: "Aish, Swanitha, Shreshta"
date: "2024-10-11"
output: html_document
---

```{r}
install.packages("R.utils")
library(R.utils)
```
Ä«
```{r}
install.packages("seqinr")
library(seqinr)
```
```{r, echo = FALSE, results = 'hide', message = FALSE, warning = FALSE}
# Define the URL for the gene expression data
URL<- "https://raw.githubusercontent.com/ghazkha/Assessment4/main/gene_expression.tsv"
# Read the gene expression data
pip=read.table(URL,stringsAsFactors = FALSE, header= TRUE,row.names = 1)
pip
# Check the structure of the data
str(pip)
# Display the values for the first six genes
head(pip, 6)
```
Objective of the above code is to import the gene expression data into R for analysis, where, read.table function is used to read TSV file, specifying that the first row contains headers and first column contains gene identifiers. This results in data frame where each row represents a gene and each column represents a sample.
OUTCOME: A well structured data frame ready for future analysis.



```{r}
# Calculate the mean of each columns (genes) and add it as a new column
pip=colMeans(t(pip))
# Display the first six rows including the new column
head(pip, 6)
```
Objective behind this code is to calculate average expression level of each gene across all samples. rowMean funstion is used in order to compute the mean for each row (gene). this mean value as a new column is called Mean_expression in the data frame. 
An updated data frame with an additional column representing the mean expression for all gene is the outcome of this code.

```{r}
# Ensure pip is a data frame
pip <- as.data.frame(pip)
# Calculate the mean of each row (genes) and add it as a new column
pip$Mean_Expression <- rowMeans(pip)
ordered_pip <- pip[order(-pip$Mean_Expression), ]
# Select and display the top 10 genes
top_10_genes <- head(ordered_pip, 10)
print(top_10_genes)
```
The above can be used to identify the genes with highest average expression levels.
Data was sorted in descending order based on Mean_Expression column, where top 10 genes were selcted from the sorted list. The above outcome is list of top 10 genes with highest mean expression values. 

```{r}
# Ensure pip is a data frame
pip <- as.data.frame(pip)
# Calculate the mean of each row (genes) and add it as a new column
pip$Mean_Expression <- rowMeans(pip)
# Determine the number of genes with a mean expression less than 10
num_genes_low_mean <- sum(pip$Mean_Expression < 10)
# Display the result
print(num_genes_low_mean)
```
The above cide determines how many genes have mean expression value below threshold of 10, where, sum function is used to count number of genes in Mean_Expression less than 10. The count of genes with mean expression values below 10, providing insights into expression landscape.

```{r}
# Create a histogram of the Mean_Expression values
hist(pip$Mean_Expression,
     # Title of the histogram
     main = "Histogram of Mean Expression Values",
     # Label for the x-axis
     xlab = "Mean Expression",
     # Label for the y-axis
     ylab = "Frequency",
     # Color of the bars
     col = "lightblue",
     # Color of the bars
     border = "black")
```
Objective here is to visualize the distribution of mean expression values across all genes. Using hist function creates a histogram of the Mean_Expression values. A histogram that visually represents the distribution of gene expression means, highlighting patterns such as central tendency and variability. 


---
title: "RNA-Seq Analysis, Growth Data Analysis, and Biological Sequence Diversity
  in Comparative Genomics"
author: "Aishwarya,shrestha,Swanitha"
date: "2024-10-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Install the readr package 
install.packages("readr")
```

```{r}
# Load the readr package
library(readr)
# Define the URL for the growth data
url <- "https://raw.githubusercontent.com/ghazkha/Assessment4/refs/heads/main/growth_data.csv"

# Read the growth data
growth_data <- read_csv(url)
# Display the first few rows of the dataset
head(growth_data)
```


```{r}
# Display the column names of the growth_data dataset
colnames(growth_data)
```
The  R code begins by installing the `readr` package and loading it to facilitate data import. It then defines a URL where the growth data CSV file is located and uses the `read_csv` function to read the data into an R object called `growth_data`. The `head()` function is utilized to display the first few rows of the dataset, providing a quick preview of the data structure. Finally, the `colnames()` function is called to extract and display the column names of the `growth_data` object, allowing users to understand the variables included in the dataset.
The dataset comprises six columns: "Site," "TreeID," and four circumference measurements (in cm) for the years 2005, 2010, 2015, and 2020, with a total of 100 rows. The "Site" column categorizes trees into "northeast" and "southwest" regions, while "TreeID" uniquely identifies each tree. The numerical columns document the circumference growth over time. Sample rows illustrate how each tree's growth is tracked across the specified years.
```{r}
# Load the necessary packages
library(readr)
# Calculate mean and standard deviation using the $ operator
mean_start <- mean(growth_data$Circumf_2005_cm, na.rm = TRUE)
sd_start <- sd(growth_data$Circumf_2005_cm, na.rm = TRUE)

mean_end <- mean(growth_data$Circumf_2020_cm, na.rm = TRUE)
sd_end <- sd(growth_data$Circumf_2020_cm, na.rm = TRUE)

# Check for NA values in the calculated statistics
if (is.na(mean_start) || is.na(sd_start) || is.na(mean_end) || is.na(sd_end)) {
  stop("One or more statistics could not be calculated due to NA values.")
}

# Create a data frame to store the statistics
circumference_stats <- data.frame(
  mean_start = mean_start,
  sd_start = sd_start,
  mean_end = mean_end,
  sd_end = sd_end
)

# Print the statistics
print(circumference_stats)
```
The  R code imports a CSV file into an R object called `growth_data` and calculates the mean and standard deviation of tree circumference for the years 2005 and 2020. It utilizes the `$` operator to access the relevant columns while excluding any missing values. The code checks for NA values in the calculated statistics and halts execution if any statistic cannot be computed. A data frame is then created to store the calculated mean and standard deviation values, which are subsequently printed. To display the column names of the `growth_data` object, the `colnames(growth_data)` function can be used.
The mean tree circumference at the start of the study (2005) was approximately 5.08 cm, with a standard deviation of 1.05 cm, indicating that the trees were relatively small and consistent in size at the beginning. By the end of the study (2020), the mean circumference increased significantly to about 49.91 cm, with a standard deviation of 22.18 cm, suggesting substantial growth over the 15-year period. The increase in standard deviation also indicates greater variability in tree growth rates, reflecting differences in individual tree responses to environmental conditions or management practices.

```{r}
# Load the necessary packages
library(readr)
library(ggplot2)

# Reshape the data using base R
growth_data_long <- data.frame(
  Site = rep(growth_data$Site, each = 2),
  Time = rep(c("Start (2005)", "End (2020)"), times = nrow(growth_data)),
  Circumference = c(growth_data$Circumf_2005_cm, growth_data$Circumf_2020_cm)
)

# Create the box plot
ggplot(growth_data_long, aes(x = Time, y = Circumference, fill = Site)) +
  geom_boxplot() +
  labs(title = "Tree Circumference at Start and End of Study",
       x = "Time",
       y = "Circumference (cm)") +
  theme_minimal() +
  theme(legend.title = element_blank())
```

The R code created a box plot to visualize tree circumference at the start (2005) and end (2020) of the study for both sites. It reshaped the `growth_data` dataset into a long format using the `data.frame()` function, which included columns for `Site`, `Time`, and `Circumference`. The `ggplot2` package was then utilized to generate the box plot, mapping `Time` to the x-axis and `Circumference` to the y-axis, with fill colors representing different sites. Customizations included a title, axis labels, and a minimal theme for clarity. The resulting box plot effectively illustrated differences in tree growth over the study period between the two sites.

```{r}
# Load necessary libraries
library(readr)
# Calculate growth from 2005 to 2020 and add it as a new column
growth_data$Growth <- growth_data$Circumf_2020_cm - growth_data$Circumf_2005_cm
# Calculate mean growth by site
mean_growth <- aggregate(Growth ~ Site, data = growth_data, FUN = mean, na.rm = TRUE)
# Print the mean growth by site
print(mean_growth)
```

The R code calculates the mean growth of trees over the last 10 years for each site. It begins by loading the `readr` library, which is necessary for reading data. The code then computes the growth from 2005 to 2020 by subtracting the circumference measured in 2005 from that measured in 2020, storing the result in a new column called `Growth` within the `growth_data` object. Next, the code uses the `aggregate()` function to calculate the mean growth, grouped by site, while ignoring any missing values with `na.rm = TRUE`. Finally, the calculated mean growth values for each site are printed to the console, providing insights into the growth performance of trees at different locations.
The northeast site had a mean growth of approximately 48.94 cm, while the southwest site had a lower mean growth of around 40.73 cm. This suggests that trees in the northeast experienced better growth compared to those in the southwest, potentially due to differences in environmental factors, soil quality, or management practices at the two sites.

```{r}
# Load necessary library
library(readr)
# Perform a t-test to compare growth between the two sites
t_test_result <- t.test(Growth ~ Site, data = growth_data)
# Display the t-test results
print(t_test_result)
# Extract and display the p-value
p_value <- t_test_result$p.value
cat("The p-value for the difference in growth between the two sites is:", p_value, "\n")
```
To estimate the p-value for the difference in 10-year growth between the two sites, a t-test was conducted using the "t.test()" function in R. The test compared the "Growth" variable between the two groups defined by the "Site" column in the dataset. The result of the t-test was printed, and the p-value was extracted and displayed using the "cat()" function to indicate whether there was a statistically significant difference in growth between the sites over the 10-year period.
The Welch Two Sample t-test comparing the 10-year mean growth between the "northeast" and "southwest" sites yielded a t-statistic of 1.9121 and a p-value of 0.05912, which is slightly above the 0.05 significance threshold. This indicates that the difference in mean growth is not statistically significant at the 5% level, though it is close. The 95% confidence interval (-0.3226 to 16.7266) includes zero, supporting the conclusion that there is no strong evidence of a difference. Despite the "northeast" site showing higher mean growth, the result suggests this difference could be due to random variation.

--- 

title: "Examining Biological sequence diversity in ecoli and anaerococcus" 

author: "Aishwarya,shrestha,Swanitha" 

date: "2024-10-11" 

output: html_document 

--- 

  

```{r setup, include=FALSE} 

# Set options for chunk output 

knitr::opts_chunk$set(echo = TRUE) 

``` 

  

This project investigates the coding DNA sequences (CDS) of Escherichia coli (E. coli) and Anaerococcus tetradius, two microorganisms with distinct ecological niches and metabolic pathways. E. coli, a well-researched bacterium found in the intestines of warm-blooded organisms, is notable for its versatility and rapid growth, making it an ideal model for studies on gene regulation and microbial interactions. In contrast, A. tetradius, associated with anaerobic environments, has fewer coding sequences and unique metabolic adaptations, offering insights into evolutionary strategies and niche specialization. 

  

The analysis began with downloading and counting the coding DNA sequences (CDS) for both Escherichia coli (E. coli) and Anaerococcus tetradius. The following code was employed to download the CDS for E. coli from the Ensembl database, decompress the file, and subsequently read the sequences: 

  

```{r} 

# Install the readr package  

install.packages("readr") 

``` 

```{r} 

library(R.utils) 

 # URL for E. coli CDS data 

URL="http://ftp.ensemblgenomes.org/pub/bacteria/release-53/fasta/bacteria_0_collection/escherichia_coli_str_k_12_substr_mg1655_gca_000005845/cds/Escherichia_coli_str_k_12_substr_mg1655_gca_000005845.ASM584v2.cds.all.fa.gz" 

  

download.file(URL,destfile="ecoli_cds.fa.gz") 

  

gunzip("ecoli_cds.fa.gz", overwrite=TRUE) 

 # URL for Anaerococcus tetradius CDS data 

URL="https://ftp.ensemblgenomes.ebi.ac.uk/pub/bacteria/release-59/fasta/bacteria_12_collection/anaerococcus_tetradius_gca_001546165/cds/Anaerococcus_tetradius_gca_001546165.ASM154616v1.cds.all.fa.gz" 

  

download.file(URL,destfile="anaerococcus_cds.fa.gz") 

  

gunzip("anaerococcus_cds.fa.gz", overwrite=TRUE) 

 # Install the seqinr package for reading FASTA files 

install.packages("seqinr") 

  

library(seqinr) 

# Read the CDS sequences for both organisms  

anaerococcus_cds <- seqinr::read.fasta("anaerococcus_cds.fa") 

  

anaerococcus_cds_count <- length(anaerococcus_cds) 

  

ecoli_cds <- seqinr::read.fasta("ecoli_cds.fa") 

  

  

ecoli_cds_count <- length(ecoli_cds) 

 # Create a data frame to summarize CDS counts 

cds_table <- data.frame( 

  

Organism = c("Anaerococcus tetradius", "E. coli"), 

  

CDS_Count = c(anaerococcus_cds_count, ecoli_cds_count) 

  

) 

 # Print the table summarizing the CDS counts 

print(cds_table) 

  

``` 

####
